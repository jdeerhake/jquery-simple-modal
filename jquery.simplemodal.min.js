!function($){function createBackdrop(){backdrop=$("<div />",{"class":"simple-modal-backdrop"}).appendTo("body")}function Modal(el,settings){$.extend(this,settings),this.el=$(el),this.isShown=!1,this.init()}var backdrop,FADE_TIME=300,defaults={"class":"simple-modal-box"};Modal.prototype={init:function(){backdrop||createBackdrop(),this.modal={},this.modal.el=$("<div />",{"class":this["class"]}).appendTo("body"),this.modal.el.append(this.el.remove().show()).css({left:0,top:0,position:"fixed"}),this.bindings()},bindings:function(){this.el.on("show",$.proxy(this,"show")),this.el.on("hide",$.proxy(this,"hide")),this.el.on("change",$.proxy(this,"center"));var triggerShow=$.proxy(function(){return this.el.trigger("show"),!1},this),triggerHide=$.proxy(function(){return this.el.trigger("hide"),!1},this);backdrop.on("click",triggerHide),this.el.on("click",".close",triggerHide),$(document).on("keyup",function(ev){27===ev.keyCode&&triggerHide()}),this.trigger&&this.trigger.on("click",triggerShow),this.el.find(".close").on("click")},show:function(){return this.isShown?!1:(this.isShown=!0,backdrop.show(),this.center(),this.modal.el.fadeIn(FADE_TIME).show(),!1)},hide:function(){return this.isShown?(this.isShown=!1,backdrop.fadeOut(FADE_TIME),this.modal.el.fadeOut(FADE_TIME,$.proxy(function(){this.el.trigger("hidden")},this)),!1):!1},center:function(){this.modal.el.css({marginLeft:-1*Math.floor(this.modal.el.outerWidth()/2),marginTop:-1*Math.floor(this.modal.el.outerHeight()/2),position:"fixed",top:"50%",left:"50%"})}},$.fn.simpleModal=function(options){var settings=$.extend({},defaults,options);return this.each(function(){new Modal(this,settings)})}}(jQuery);